<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bringer Shop | MM2</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050609;
            --sidebar: #0b0d13;
            --card: #0e111a;
            --accent: #5865f2;
            --border: rgba(255, 255, 255, 0.06);
            --text-muted: #6e727d;
            --success: #2ecc71;
        }

        body { margin: 0; font-family: 'Manrope', sans-serif; background: var(--bg); color: #fff; display: flex; flex-direction: column; overflow-x: hidden; }

        /* –ê–î–ê–ü–¢–ò–í–ù–û–ï –ú–ï–ù–Æ –î–õ–Ø –¢–ï–õ–ï–§–û–ù–ê */
        .sidebar { width: 100%; background: var(--sidebar); border-bottom: 1px solid var(--border); padding: 15px; box-sizing: border-box; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        .logo { font-size: 20px; font-weight: 800; color: #fff; text-decoration: none; width: 100%; text-align: center; margin-bottom: 10px; }
        .logo span { color: var(--accent); }
        
        .nav-link { padding: 8px 12px; border-radius: 10px; color: var(--text-muted); text-decoration: none; font-weight: 600; cursor: pointer; font-size: 13px; background: rgba(255,255,255,0.03); }
        .nav-link.active { background: var(--accent); color: #fff; }

        /* MAIN CONTENT */
        .main { padding: 20px; box-sizing: border-box; }
        .search-bar { width: 100%; background: var(--card); border: 1px solid var(--border); padding: 12px; border-radius: 12px; color: #fff; margin-bottom: 20px; box-sizing: border-box; }

        .section-title { font-size: 18px; font-weight: 800; margin: 20px 0 15px; border-left: 4px solid var(--accent); padding-left: 10px; }
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }

        /* CARD */
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 20px; padding: 12px; display: flex; flex-direction: column; align-items: center; }
        .img-wrap { width: 100%; height: 100px; display: flex; align-items: center; justify-content: center; }
        .img-wrap img { max-width: 80px; max-height: 80px; }
        .name { font-size: 13px; font-weight: 700; margin: 10px 0; text-align: center; height: 32px; overflow: hidden; }
        
        .buy-btn { width: 100%; background: var(--accent); border: none; color: #fff; padding: 10px; border-radius: 10px; font-weight: 700; cursor: pointer; font-size: 12px; }

        /* MODALS */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; align-items: center; justify-content: center; }
        .modal-content { background: var(--sidebar); border: 1px solid var(--border); border-radius: 20px; width: 90%; padding: 20px; box-sizing: border-box; }
        
        .cart-item { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; border-bottom: 1px solid var(--border); padding-bottom: 10px; }
        .cart-item img { width: 40px; }
        .total-area { margin-top: 15px; font-weight: 800; font-size: 18px; text-align: right; }
        .input-field { width: 100%; background: var(--card); border: 1px solid var(--border); padding: 12px; border-radius: 10px; color: #fff; margin-top: 10px; box-sizing: border-box; }
    </style>
</head>
<body>

    <aside class="sidebar">
        <a href="#" class="logo">Bringer <span>Shop</span></a>
        <div class="nav-link active" data-cat="all" onclick="showCat('all')">–í—Å–µ</div>
        <div class="nav-link" onclick="toggleCart()">üõí –ö–æ—Ä–∑–∏–Ω–∞ (<span id="cart-count">0</span>)</div>
        <div class="nav-link" data-cat="pistols" onclick="showCat('pistols')">–ü–∏—Å—Ç–æ–ª–µ—Ç—ã</div>
        <div class="nav-link" data-cat="godly" onclick="showCat('godly')">–ù–æ–∂–∏</div>
    </aside>

    <main class="main">
        <input type="text" class="search-bar" id="search" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤...">
        <div id="content"></div>
    </main>

    <div class="modal" id="cart-modal">
        <div class="modal-content">
            <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
            <div id="cart-items-list"></div>
            <div class="total-area">–ò—Ç–æ–≥–æ: <span id="total-price">0 $</span></div>
            <button class="buy-btn" style="margin-top:20px" onclick="openOrderForm()">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
            <button class="buy-btn" style="background:transparent" onclick="toggleCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div class="modal" id="order-modal">
        <div class="modal-content">
            <h2>–î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞</h2>
            <input type="text" id="rbx-nick" class="input-field" placeholder="–ù–∏–∫ –≤ Roblox">
            <textarea id="order-note" class="input-field" style="height: 60px" placeholder="–ó–∞–º–µ—Ç–∫–∞"></textarea>
            <button class="buy-btn" style="margin-top:20px" onclick="sendOrder()">–ü–û–î–¢–í–ï–†–î–ò–¢–¨</button>
            <button class="buy-btn" style="background:transparent" onclick="closeOrderForm()">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let cart = [];
        const inventory = [
            { id: "pistols", name: "Shark Gun", price: 115, img: "https://vignette.wikia.nocookie.net/murder-mystery-2/images/c/ca/Shark.png" },
            { id: "pistols", name: "Gingerscope", price: 7450, img: "https://vignette.wikia.nocookie.net/murder-mystery-2/images/4/4d/Gingerscope.png" },
            { id: "pistols", name: "Icepiercer", price: 425, img: "https://vignette.wikia.nocookie.net/murder-mystery-2/images/8/8c/Icepiercer.png" },
            { id: "godly", name: "Bat", price: 380, img: "https://vignette.wikia.nocookie.net/murder-mystery-2/images/0/08/Bat.png" },
            { id: "ancient", name: "Harvester", price: 540, img: "https://vignette.wikia.nocookie.net/murder-mystery-2/images/b/b3/Harvester.png" }
        ];

        function addToCart(name) {
            const item = inventory.find(i => i.name === name);
            cart.push(item);
            updateCartUI();
            tg.HapticFeedback.impactOccurred('light');
        }

        function updateCartUI() {
            document.getElementById('cart-count').textContent = cart.length;
            const list = document.getElementById('cart-items-list');
            list.innerHTML = "";
            let total = 0;
            cart.forEach((item, index) => {
                total += item.price;
                list.innerHTML += `<div class="cart-item"><img src="${item.img}"> <span>${item.name}</span></div>`;
            });
            document.getElementById('total-price').textContent = total + " $";
        }

        function toggleCart() {
            const m = document.getElementById('cart-modal');
            m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
        }

        function openOrderForm() {
            if (cart.length === 0) return;
            document.getElementById('cart-modal').style.display = 'none';
            document.getElementById('order-modal').style.display = 'flex';
        }

        function closeOrderForm() { document.getElementById('order-modal').style.display = 'none'; }

        // –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò
        function sendOrder() {
            const rbx = document.getElementById('rbx-nick').value.trim();
            if (!rbx) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫ Roblox!");

            const data = {
                items: cart.map(i => i.name).join(', '),
                total: document.getElementById('total-price').textContent,
                nickname: rbx,
                note: document.getElementById('order-note').value
            };

            // –û–¢–ü–†–ê–í–õ–Ø–ï–ú –î–ê–ù–ù–´–ï –ë–û–¢–£ (–û–∫–Ω–æ –∑–∞–∫—Ä–æ–µ—Ç—Å—è —Å–∞–º–æ)
            tg.sendData(JSON.stringify(data));
        }

        function render(filter = 'all', query = '') {
            const container = document.getElementById('content');
            container.innerHTML = '<div class="grid"></div>';
            const grid = container.querySelector('.grid');
            
            inventory.forEach(item => {
                if ((filter === 'all' || item.id === filter) && item.name.toLowerCase().includes(query.toLowerCase())) {
                    grid.innerHTML += `
                        <div class="card">
                            <div class="img-wrap"><img src="${item.img}"></div>
                            <div class="name">${item.name}</div>
                            <button class="buy-btn" onclick="addToCart('${item.name}')">${item.price} $</button>
                        </div>`;
                }
            });
        }

        function showCat(id) {
            document.querySelectorAll('.nav-link').forEach(l => l.classList.toggle('active', l.dataset.cat === id));
            render(id);
        }

        document.getElementById('search').addEventListener('input', (e) => render('all', e.target.value));
        render();
    </script>
</body>
</html>
